<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Voice-over Script Length Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Paste your voice-over script, pick language and speaking pace, and instantly see word counts, estimated read time, ad-slot fit, and safety buffer. 100% browser-based.">
  <meta name="robots" content="index,follow">
  <link rel="canonical" href="https://voiceoveraihub.com/tools/script_length/script_length.html" />
  <link rel="alternate" hreflang="en" href="https://voiceoveraihub.com/tools/script_length/script_length.html" />
  <link rel="alternate" hreflang="ko" href="https://voiceoveraihub.com/ko/tools/script_length/script_length.html" />
  <meta property="og:title" content="Voice-over Script Length Calculator | Voiceover AI Hub" />
  <meta property="og:description" content="Paste your script and get instant word counts, duration, ad-slot fit, and safety buffer. All calculations stay in your browser." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://voiceoveraihub.com/tools/script_length/script_length.html" />

  <style>
    :root {
      --bg: #0f172a;
      --bg-soft: #111827;
      --panel: #020617;
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.12);
      --accent-strong: rgba(56, 189, 248, 0.9);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: #1f2937;
      --danger: #f97373;
      --radius-lg: 18px;
      --radius-sm: 10px;
      --shadow-soft: 0 18px 45px rgba(15, 23, 42, 0.7);
      --shadow-chip: 0 10px 25px rgba(15, 23, 42, 0.8);
    }

    body.theme-light {
      --bg: #f8fafc;
      --bg-soft: #eef2ff;
      --panel: #ffffff;
      --accent: #0ea5e9;
      --accent-soft: rgba(14, 165, 233, 0.12);
      --accent-strong: rgba(14, 165, 233, 0.9);
      --text: #0f172a;
      --muted: #475569;
      --border: #d4d7dd;
      --danger: #dc2626;
      --shadow-soft: 0 18px 35px rgba(15, 23, 42, 0.12);
      --shadow-chip: 0 10px 25px rgba(15, 23, 42, 0.12);
      background: radial-gradient(circle at top, #e2e8f0 0, #ffffff 60%);
      color: var(--text);
    }

    * {
      box-sizing: border-box;
    }

    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    body {
      margin: 0;
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1e293b 0, #020617 55%);
      color: var(--text);
      line-height: 1.6;
    }

    .page-shell {
      width: 100%;
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 clamp(1.25rem, 4vw, 3rem);
    }

    .site-header {
      position: sticky;
      top: 0;
      z-index: 20;
      background: rgba(2, 6, 23, 0.9);
      border-bottom: 1px solid rgba(148, 163, 184, 0.15);
      backdrop-filter: blur(12px);
    }

    .site-bar {
      display: flex;
      align-items: center;
      gap: 0.65rem;
      flex-wrap: wrap;
      padding: 0.75rem 0;
    }

    .brand {
      display: inline-flex;
      align-items: center;
      gap: 0.6rem;
      color: var(--text);
      font-weight: 700;
      letter-spacing: -0.02em;
      text-decoration: none;
    }

    .brand img {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      object-fit: cover;
    }

    .site-nav {
      display: flex;
      gap: 0.5rem;
      align-items: center;
      flex-wrap: wrap;
      margin-left: auto;
    }

    .site-nav a {
      color: #e2e8f0;
      text-decoration: none;
      font-size: 0.85rem;
      padding: 0.45rem 0.9rem;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.65);
    }

    .site-nav a:hover {
      border-color: rgba(255, 255, 255, 0.35);
      color: #fff;
    }

    .lang-link {
      font-size: 0.8rem;
      color: #e2e8f0;
      text-decoration: none;
      padding: 0.4rem 0.9rem;
      border-radius: 999px;
      border: 1px solid rgba(20, 184, 166, 0.5);
      background: rgba(20, 184, 166, 0.12);
    }

    .lang-link:hover {
      color: #fff;
      border-color: rgba(20, 184, 166, 0.7);
    }

    .theme-toggle {
      width: 40px;
      height: 40px;
      padding: 0;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 1.05rem;
      color: #e2e8f0;
      text-decoration: none;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.35);
      background: rgba(15, 23, 42, 0.65);
      cursor: pointer;
      transition: border-color 0.1s ease, color 0.1s ease, box-shadow 0.1s ease, background 0.1s ease;
    }

    .theme-toggle:hover {
      border-color: var(--accent);
      color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
    }

    body.theme-light .site-header {
      background: rgba(255, 255, 255, 0.9);
      border-bottom: 1px solid rgba(148, 163, 184, 0.4);
    }

    body.theme-light .site-nav a {
      color: #0f172a;
      border: 1px solid #cbd5e1;
      background: #e2e8f0;
    }

    body.theme-light .site-nav a:hover {
      color: #0f172a;
      border-color: var(--accent);
    }

    body.theme-light .lang-link {
      color: #0f172a;
      border: 1px solid rgba(16, 185, 129, 0.45);
      background: rgba(16, 185, 129, 0.16);
    }

    body.theme-light .lang-link:hover {
      color: #0f172a;
      border-color: rgba(16, 185, 129, 0.7);
    }

    body.theme-light .theme-toggle {
      color: #0f172a;
      border: 1px solid #cbd5e1;
      background: #f8fafc;
    }

    body.theme-light .theme-toggle:hover {
      color: var(--accent);
      border-color: var(--accent);
      box-shadow: 0 0 0 1px rgba(14, 165, 233, 0.35);
    }

    .tool-hero {
      padding: 34px 0 18px;
      display: flex;
      flex-wrap: wrap;
      gap: 14px;
      align-items: flex-start;
    }

    .tool-hero h1 {
      margin: 0 0 0.5rem 0;
      font-size: clamp(2rem, 3vw, 2.6rem);
      line-height: 1.1;
    }

    .tool-hero p {
      margin: 0 0 0.9rem 0;
      color: var(--muted);
      max-width: 720px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.35rem 0.8rem;
      border-radius: 999px;
      border: 1px solid rgba(99, 102, 241, 0.45);
      color: #e2e8f0;
      background: rgba(99, 102, 241, 0.16);
      font-size: 0.78rem;
    }

    .hero-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .hero-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
      padding: 0.6rem 1.2rem;
      border-radius: 999px;
      text-decoration: none;
      font-weight: 600;
      font-size: 0.88rem;
    }

    .hero-btn.primary {
      background: linear-gradient(120deg, #6366f1 0%, #14b8a6 80%);
      color: #fff;
      border: none;
    }

    .hero-btn.secondary {
      background: rgba(15, 23, 42, 0.25);
      color: #e2e8f0;
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .site-footer {
      padding: 24px 0 28px;
      border-top: 1px solid rgba(148, 163, 184, 0.12);
      color: var(--muted);
      font-size: 0.8rem;
      margin-top: 36px;
    }

    .footer-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.65rem;
      flex-wrap: wrap;
    }

    .footer-links {
      display: inline-flex;
      gap: 0.75rem;
      align-items: center;
    }

    .footer-links a,
    .footer-links button {
      color: var(--muted);
      text-decoration: none;
      background: none;
      border: none;
      cursor: pointer;
      font-size: 0.8rem;
      padding: 0;
    }

    .footer-links a:hover,
    .footer-links button:hover {
      text-decoration: underline;
      color: #e2e8f0;
    }

    .app {
      width: 100%;
      max-width: 1180px;
      background: radial-gradient(circle at top left, #0b1120 0, #020617 55%);
      border-radius: 24px;
      border: 1px solid rgba(148, 163, 184, 0.3);
      box-shadow: var(--shadow-soft);
      padding: 20px;
      position: relative;
      overflow: hidden;
      margin-bottom: 32px;
    }

    @media (min-width: 768px) {
      .app {
        padding: 24px 28px 28px;
      }
    }

    @media (min-width: 1280px) {
      .app {
        max-width: 1280px;
        padding: 30px 32px 34px;
      }
      .app-inner {
        grid-template-columns: minmax(0, 1.8fr) minmax(0, 1.2fr);
        gap: 26px;
      }
      .title {
        font-size: 1.55rem;
      }
      textarea {
        min-height: 240px;
        max-height: 480px;
      }
    }

    .app::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at 0 0, rgba(56, 189, 248, 0.18), transparent 55%),
        radial-gradient(circle at 100% 10%, rgba(129, 140, 248, 0.16), transparent 60%);
      mix-blend-mode: screen;
      pointer-events: none;
      opacity: 0.6;
    }

    body.theme-light .app {
      background: linear-gradient(160deg, #ffffff 0%, #e8edf5 75%);
      border: 1px solid #d6deea;
      box-shadow: 0 18px 35px rgba(15, 23, 42, 0.12);
    }

    body.theme-light .app::before {
      background:
        radial-gradient(circle at 0 0, rgba(14, 165, 233, 0.16), transparent 55%),
        radial-gradient(circle at 100% 10%, rgba(99, 102, 241, 0.12), transparent 60%);
      mix-blend-mode: normal;
      opacity: 0.6;
    }

    .app-inner {
      position: relative;
      z-index: 1;
      display: grid;
      grid-template-columns: minmax(0, 1.7fr) minmax(0, 1.2fr);
      gap: 22px;
    }

    @media (max-width: 900px) {
      .app-inner {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    .header {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 18px;
      gap: 10px;
    }

    .title-group {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .title {
      font-size: 1.4rem;
      letter-spacing: 0.03em;
      font-weight: 650;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .title span.logo-dot {
      width: 10px;
      height: 10px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #f9fafb, #38bdf8);
      box-shadow: 0 0 18px rgba(56, 189, 248, 0.95);
    }

    .subtitle {
      font-size: 0.83rem;
      color: var(--muted);
    }

    .chip-row {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(15, 23, 42, 0.7);
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: var(--shadow-chip);
      font-size: 0.72rem;
      color: #e5e7eb;
    }

    body.theme-light .chip-row {
      background: #e2e8f0;
      border: 1px solid #cbd5e1;
      box-shadow: var(--shadow-chip);
      color: #0f172a;
    }

    .chip-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: #22c55e;
      box-shadow: 0 0 12px rgba(34, 197, 94, 0.9);
    }

    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.7rem;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.86);
      border: 1px solid rgba(56, 189, 248, 0.6);
      box-shadow: 0 0 18px rgba(56, 189, 248, 0.45);
      white-space: nowrap;
    }

    .badge-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--accent);
    }

    .card {
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.94));
      border-radius: var(--radius-lg);
      border: 1px solid rgba(15, 23, 42, 1);
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.95);
      padding: 14px 14px 16px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, rgba(148, 163, 184, 0.09), transparent 65%);
      opacity: 0.9;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .card-title {
      font-size: 0.96rem;
      font-weight: 550;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      color: #e5e7eb;
    }

    .card-caption {
      font-size: 0.76rem;
      color: var(--muted);
    }

    body.theme-light .hero-btn.secondary {
      background: #f1f5f9;
      color: #0f172a;
      border: 1px solid #cbd5e1;
    }

    body.theme-light .pill {
      border: 1px solid rgba(14, 165, 233, 0.6);
      color: #0f172a;
      background: rgba(14, 165, 233, 0.14);
    }

    body.theme-light .badge {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(14, 165, 233, 0.6);
      box-shadow: 0 0 12px rgba(14, 165, 233, 0.35);
      color: #0f172a;
    }

    body.theme-light .card {
      background: linear-gradient(145deg, #ffffff, #f8fafc);
      border: 1px solid #e2e8f0;
      box-shadow: 0 18px 35px rgba(15, 23, 42, 0.16);
    }

    body.theme-light .card::before {
      background: radial-gradient(circle at top, rgba(59, 130, 246, 0.12), transparent 65%);
    }

    body.theme-light .card-title {
      color: #0f172a;
    }

    .field-group {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      flex-wrap: wrap;
    }

    .field {
      flex: 1;
      min-width: 120px;
    }

    .label {
      display: block;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.07em;
      margin-bottom: 5px;
      color: var(--muted);
    }

    select {
      width: 100%;
      padding: 7px 9px;
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 1);
      background: radial-gradient(circle at top left, #020617, #020617);
      color: var(--text);
      font-size: 0.83rem;
      outline: none;
      transition: border-color 0.1s ease, box-shadow 0.1s ease;
    }

    select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent-strong), 0 0 0 4px rgba(56, 189, 248, 0.25);
    }

    body.theme-light select,
    body.theme-light textarea {
      background: #ffffff;
      border: 1px solid #cbd5e1;
      color: #0f172a;
    }

    textarea {
      width: 100%;
      min-height: 210px;
      max-height: 420px;
      resize: vertical;
      padding: 10px 11px;
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 1);
      background: radial-gradient(circle at top left, #020617, #020617);
      color: var(--text);
      font-size: 0.86rem;
      line-height: 1.5;
      transition: border-color 0.1s ease, box-shadow 0.1s ease;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--accent-strong), 0 0 0 4px rgba(56, 189, 248, 0.25);
    }

    .helper-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 6px;
      font-size: 0.72rem;
      color: var(--muted);
      gap: 10px;
      flex-wrap: wrap;
    }

    .helper-actions {
      display: inline-flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .helper-row button,
    .chip-button {
      border-radius: 999px;
      padding: 4px 8px;
      font-size: 0.74rem;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.5);
      color: #e5e7eb;
      cursor: pointer;
      transition: border-color 0.1s ease, box-shadow 0.1s ease, color 0.1s ease;
    }

    body.theme-light .helper-row button,
    body.theme-light .chip-button {
      background: #f8fafc;
      border: 1px solid #cbd5e1;
      color: #0f172a;
    }

    .helper-row button:hover,
    .chip-button:hover {
      border-color: var(--accent);
      color: var(--accent);
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.4);
    }

    body.theme-light .helper-row button:hover,
    body.theme-light .chip-button:hover {
      box-shadow: 0 0 0 1px rgba(14, 165, 233, 0.35);
    }

    .chip-button {
      padding: 6px 10px;
      font-size: 0.75rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    /* Results side */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
      margin-bottom: 12px;
    }

    @media (max-width: 480px) {
      .stats-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 640px) {
      .app {
        padding: 16px;
        border-radius: 18px;
      }
      .app-inner {
        gap: 16px;
      }
      .card {
        padding: 12px;
      }
      .card-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 8px;
      }
      .chip-button {
        width: 100%;
        justify-content: center;
      }
      .helper-actions {
        width: 100%;
      }
      .helper-actions button {
        flex: 1;
      }
      .stats-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }

    @media (max-width: 760px) {
      .site-bar {
        flex-direction: column;
        align-items: flex-start;
      }
      .site-nav {
        width: 100%;
        margin-left: 0;
      }
      .site-nav a {
        width: auto;
      }
      .hero-btn {
        width: 100%;
        justify-content: center;
      }
    }

    .consent-banner {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      left: 1rem;
      max-width: 420px;
      margin: 0 auto;
      background: rgba(15, 23, 42, 0.92);
      border: 1px solid rgba(148, 163, 184, 0.2);
      border-radius: 1rem;
      padding: 1rem 1.2rem;
      color: #e2e8f0;
      font-size: 0.85rem;
      line-height: 1.4;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.45);
      z-index: 100;
    }

    .consent-copy {
      margin-top: 0.35rem;
      font-size: 0.78rem;
      color: rgba(226, 232, 240, 0.95);
    }

    .consent-toggle {
      margin-top: 0.85rem;
      display: flex;
      gap: 0.45rem;
      align-items: flex-start;
      font-size: 0.78rem;
    }

    .consent-toggle input {
      width: 18px;
      height: 18px;
      accent-color: var(--accent);
      margin-top: 0.15rem;
    }

    .consent-note {
      margin-top: 0.45rem;
      font-size: 0.72rem;
      color: rgba(226, 232, 240, 0.75);
    }
    .consent-banner a {
      color: #c7d2fe;
    }

    .consent-actions {
      margin-top: 0.85rem;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .btn-primary {
      background: linear-gradient(120deg, #6366f1 0%, #14b8a6 80%);
      color: #fff;
      border: none;
      border-radius: 9999px;
      padding: 0.6rem 1.35rem;
      font-weight: 600;
      display: inline-flex;
      gap: 0.5rem;
      align-items: center;
      cursor: pointer;
      text-decoration: none;
      font-size: 0.85rem;
    }

    .btn-outline {
      background: rgba(15, 23, 42, 0.25);
      border: 1px solid rgba(148, 163, 184, 0.35);
      color: #e2e8f0;
      border-radius: 9999px;
      padding: 0.5rem 1.1rem;
      font-size: 0.82rem;
      cursor: pointer;
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid rgba(148, 163, 184, 0.4);
      color: #e2e8f0;
      border-radius: 9999px;
      padding: 0.5rem 1.1rem;
      font-size: 0.82rem;
      cursor: pointer;
    }

    .cookie-settings-link {
      background: none;
      border: none;
      color: var(--accent);
      font-size: 0.8rem;
      cursor: pointer;
      padding: 0;
    }

    .cookie-settings-link:hover,
    .cookie-settings-link:focus {
      text-decoration: underline;
    }

    .stat {
      padding: 9px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: linear-gradient(145deg, #020617, #020617);
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .stat-label {
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--muted);
    }

    .stat-value {
      font-size: 1.1rem;
      font-weight: 600;
    }

    .stat-hint {
      font-size: 0.76rem;
      color: var(--muted);
    }

    .stat-value.accent {
      color: var(--accent);
    }

    body.theme-light .stat {
      background: linear-gradient(145deg, #f8fafc, #eef2f7);
      border: 1px solid #d6deea;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.08);
    }

    .slot-panel {
      margin-top: 6px;
      padding: 9px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: radial-gradient(circle at top, rgba(56, 189, 248, 0.15), #020617 55%);
    }

    .slot-title {
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.09em;
      color: var(--muted);
      margin-bottom: 6px;
    }

    .slot-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .slot {
      min-width: 56px;
      padding: 4px 8px;
      border-radius: 999px;
      font-size: 0.72rem;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.96);
      text-align: center;
      color: var(--muted);
      position: relative;
    }

    .slot.best-fit {
      border-color: var(--accent);
      background: var(--accent-soft);
      color: #e5e7eb;
      box-shadow: 0 0 0 1px rgba(56, 189, 248, 0.8);
    }

    .slot.too-short,
    .slot.too-long {
      opacity: 0.5;
    }

    .slot span.tag {
      display: block;
      font-size: 0.65rem;
      margin-top: 2px;
      color: var(--muted);
    }

    body.theme-light .slot-panel {
      background: linear-gradient(145deg, #eef2ff, #ffffff);
      border: 1px solid #dfe7ef;
    }

    body.theme-light .slot {
      background: #f8fafc;
      border: 1px solid #cbd5e1;
      color: #475569;
    }

    body.theme-light .slot.best-fit {
      color: #0f172a;
      background: var(--accent-soft);
      box-shadow: 0 0 0 1px rgba(14, 165, 233, 0.7);
    }

    body.theme-light .slot span.tag {
      color: #6b7280;
    }

    body.theme-light .consent-banner {
      background: rgba(255, 255, 255, 0.96);
      border: 1px solid #d6deea;
      color: #0f172a;
      box-shadow: 0 20px 50px rgba(15, 23, 42, 0.12);
    }

    body.theme-light .consent-copy {
      color: #475569;
    }

    body.theme-light .consent-note {
      color: #475569;
    }

    body.theme-light .consent-toggle input {
      accent-color: #0ea5e9;
    }

    body.theme-light .consent-banner a {
      color: #0ea5e9;
    }

    body.theme-light .btn-ghost,
    body.theme-light .btn-outline {
      background: #f8fafc;
      border: 1px solid #cbd5e1;
      color: #0f172a;
    }

    .note {
      margin-top: 8px;
      font-size: 0.72rem;
      color: var(--muted);
    }

    .note strong {
      font-weight: 500;
      color: #e5e7eb;
    }

    body.theme-light .note {
      color: #475569;
    }

    body.theme-light .note strong {
      color: #0f172a;
    }

    .alert {
      margin-top: 6px;
      font-size: 0.74rem;
      color: var(--danger);
    }

    .buffer-hint {
      margin-top: 8px;
      font-size: 0.74rem;
      color: #a5f3fc;
    }

    body.theme-light .buffer-hint {
      color: #0ea5e9;
    }

    .alert-inline {
      display: inline-block;
      margin-left: 4px;
      color: var(--danger);
    }

    .toggle {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 0.8rem;
      color: var(--text);
      padding: 8px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid rgba(55, 65, 81, 1);
      background: rgba(15, 23, 42, 0.75);
    }

    body.theme-light .toggle {
      background: #f8fafc;
      border: 1px solid #cbd5e1;
      color: #0f172a;
    }

    .toggle input {
      accent-color: var(--accent);
      width: 16px;
      height: 16px;
    }

    .helper-note {
      color: var(--muted);
    }
  </style>
</head>
<body>
<header class="site-header">
  <div class="page-shell">
    <div class="site-bar">
      <a href="/" class="brand" aria-label="Voiceover AI Hub home">
        <img src="/favicons/favicon-48x48.png" alt="Voiceover AI Hub logo" />
        <span>Voiceover AI Hub</span>
      </a>
      <nav class="site-nav">
        <a href="/">Home</a>
        <a href="#calculator">Calculator</a>
        <a href="/privacy.html">Privacy</a>
      </nav>
      <button type="button" class="theme-toggle" id="themeToggle" aria-pressed="false" aria-label="Light theme" title="Light theme">‚òÄÔ∏è</button>
      <a class="lang-link" href="/ko/tools/script_length/script_length.html" hreflang="ko">ÌïúÍµ≠Ïñ¥</a>
    </div>
  </div>
</header>

<main>
  <div class="page-shell">
    <section class="tool-hero">
      <div>
        <span class="pill">Tool ¬∑ Script timing</span>
        <h1>Voice-over Script Length Calculator</h1>
        <p>
          Paste your voice-over script, pick language and speaking pace, and get instant estimates for word count, duration, and ad-slot fit with a safety buffer. All calculations stay on your device.
        </p>
        <div class="hero-actions">
          <a class="hero-btn primary" href="#calculator">Jump to calculator</a>
          <a class="hero-btn secondary" href="/">Back to main guide</a>
          <a class="hero-btn secondary" href="https://try.elevenlabs.io/5cfx02tsbxm9" target="_blank" rel="noopener noreferrer">Try ElevenLabs</a>
        </div>
      </div>
    </section>
  </div>

  <div class="page-shell" id="calculator">
    <div class="app">
      <div class="app-inner">
        <!-- Left column: input -->
        <section>
          <header class="header">
            <div class="title-group">
              <div class="title">
                <span class="logo-dot"></span>
                Script Length Calculator
              </div>
              <div class="subtitle">
                Counts words and estimates reading time for spoken voice-over.
              </div>
            </div>
            <div class="chip-row">
              <span class="chip-dot"></span>
              Live estimates
              <span>¬∑</span>
              Client-side only
            </div>
          </header>

          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Script input</div>
                  <div class="card-caption">Paste or type your script below.</div>
                </div>
                <div class="badge">
                  <span class="badge-dot"></span>
                  No data leaves the browser
                </div>
              </div>

              <div class="field-group">
                <div class="field">
                  <label for="language" class="label">Language</label>
                  <select id="language" aria-describedby="languageHint">
                    <option value="en">English</option>
                    <option value="fr">French</option>
                    <option value="es">Spanish</option>
                    <option value="de">German</option>
                    <option value="ko">Korean</option>
                  </select>
                </div>
                <div class="field">
                  <label for="pace" class="label">Speaking pace</label>
                  <select id="pace" aria-describedby="paceHint">
                    <option value="slow">Slow</option>
                    <option value="normal" selected>Normal</option>
                    <option value="fast">Fast</option>
                  </select>
                </div>
              </div>

              <div class="field-group">
                <label class="toggle" for="countNumbers">
                  <input type="checkbox" id="countNumbers" checked>
                  <span>Count numbers as words</span>
                </label>
              </div>

              <textarea id="scriptInput"
                        aria-describedby="inputHint limitHint"
                        placeholder="Paste your script here..."></textarea>

              <div class="helper-row">
                <span class="helper-note" id="inputHint">Updates automatically while you type.</span>
                <div class="helper-actions">
                  <button type="button" id="sampleButton">Sample script</button>
                  <button type="button" id="clearButton">Clear</button>
                </div>
              </div>
              <div class="helper-row">
                <span class="helper-note" id="limitHint">
                  Max 12,000 characters. Extra whitespace is trimmed on paste.
                </span>
                <span class="alert-inline" id="limitAlert" style="display:none;">Trimmed to the limit.</span>
              </div>

              <div class="sr-only" id="languageHint">Language changes the fixed words per minute rate.</div>
              <div class="sr-only" id="paceHint">Select a speaking pace to adjust estimated read time.</div>
            </div>
          </div>
        </section>

        <!-- Right column: results -->
        <section>
          <div class="card">
            <div class="card-inner">
              <div class="card-header">
                <div>
                  <div class="card-title">Timing result</div>
                  <div class="card-caption">
                    Based on current script, language, and pace settings.
                  </div>
                </div>
                <button type="button" class="chip-button" id="copyButton">
                  Copy stats
                  <span class="alert-inline" id="copyFeedback" style="display:none;">Copied</span>
                </button>
              </div>

              <div id="liveRegion" class="sr-only" role="status" aria-live="polite"></div>

              <div class="stats-grid">
                <div class="stat">
                  <div class="stat-label">Word count</div>
                  <div class="stat-value" id="wordCount">0</div>
                  <div class="stat-hint" id="charCount">0 characters</div>
                </div>
                <div class="stat">
                  <div class="stat-label">Estimated duration</div>
                  <div class="stat-value accent" id="duration">0 s</div>
                  <div class="stat-hint" id="durationDetail">0:00 (min:sec)</div>
                </div>
              </div>

              <div class="stat">
                <div class="stat-label">Words per minute used</div>
                <div class="stat-value" id="wpmValue">0</div>
                <div class="stat-hint">
                  Fixed WPM values are used for each language and pace setting.
                </div>
              </div>

              <div class="slot-panel">
                <div class="slot-title">Ad slot guide</div>
                <div class="slot-row">
                  <div class="slot" data-seconds="15">
                    15 s
                    <span class="tag"></span>
                  </div>
                  <div class="slot" data-seconds="30">
                    30 s
                    <span class="tag"></span>
                  </div>
                  <div class="slot" data-seconds="45">
                    45 s
                    <span class="tag"></span>
                  </div>
                  <div class="slot" data-seconds="60">
                    60 s
                    <span class="tag"></span>
                  </div>
                  <div class="slot" data-seconds="90">
                    90 s
                    <span class="tag"></span>
                  </div>
                </div>
              </div>

              <p class="buffer-hint" id="bufferMessage">
                Safety buffer applied when available.
              </p>

              <p class="note">
                <strong>Note:</strong> This calculator uses fixed words-per-minute values
                per language and pace. It is a mechanical estimate of read time.
              </p>
              <p class="alert" id="longAlert" style="display:none;">
                Estimated duration is longer than 90 seconds; it may not fit
                in standard 15‚Äì90 second ad slots.
              </p>
            </div>
          </div>
        </section>
      </div>
    </div>
  </div>
</main>

<footer class="site-footer">
  <div class="page-shell footer-bar">
    <span>Voiceover AI Hub ¬∑ Tools.</span>
    <span class="footer-links">
      <a href="/privacy.html">Privacy & cookies</a>
      <button type="button" class="cookie-settings-link" data-consent-open>Cookie settings</button>
    </span>
  </div>
</footer>

<div class="consent-banner" data-consent-banner hidden aria-hidden="true">
  <strong>Privacy choices</strong>
  <p class="consent-copy">
    We use Google Analytics 4 to measure visits. Analytics cookies only load if you allow them. Read the
    <a href="/privacy.html">Privacy & Cookies Policy</a> for the full details.
  </p>
  <label class="consent-toggle">
    <input type="checkbox" data-consent-toggle />
    <span>Analytics (GA4) ‚Äî helps us learn what tutorials people read.</span>
  </label>
  <p class="consent-note">You can change or withdraw consent anytime via ‚ÄúCookie settings.‚Äù</p>
  <div class="consent-actions">
    <button class="btn-primary" type="button" data-consent-accept>Allow analytics</button>
    <button class="btn-ghost" type="button" data-consent-reject>Reject all</button>
    <button class="btn-outline" type="button" data-consent-save>Save choices</button>
  </div>
</div>
<script defer src="/consent.js"></script>
<script>
  // Words-per-minute settings used by the calculator.
  // These constants are only used for internal calculation.
  const WPM_TABLE = {
    en: { slow: 120, normal: 150, fast: 180 },
    fr: { slow: 130, normal: 160, fast: 190 },
    es: { slow: 130, normal: 160, fast: 190 },
    de: { slow: 125, normal: 155, fast: 185 },
    ko: { slow: 130, normal: 160, fast: 190 }
  };

  const MAX_CHARS = 12000;
  const BUFFER_MULTIPLIER = 1.12;
  const BUFFER_LABEL = Math.round((BUFFER_MULTIPLIER - 1) * 100);
  const STORAGE_KEY = "voiceover_script_state";
  const THEME_KEY = "voaih_theme";
  const THEME_LABELS = { light: "Dark theme", dark: "Light theme" };
  const THEME_ICONS = { light: "üåô", dark: "‚òÄÔ∏è" };
  const SAMPLE_SCRIPTS = {
    en: `Introducing the Voiceover AI Hub, your fast lane for recording-ready scripts. Paste your copy, pick a language and pace, and get an instant read-time estimate with ad slot guidance. This demo uses fixed words-per-minute settings, so add a small buffer if you expect dramatic pauses or a slower read.`,
    fr: `Voici le Voiceover AI Hub, votre raccourci pour des scripts pr√™ts √† √™tre enregistr√©s. Collez votre texte, choisissez la langue et le d√©bit, et obtenez instantan√©ment une estimation du temps de lecture avec des indications pour le placement des encarts publicitaires. Cette d√©mo utilise un nombre fixe de mots par minute ; pr√©voyez donc une petite marge si vous attendez des pauses dramatiques ou une lecture plus lente.`,
    es: `Voiceover AI Hub es tu v√≠a r√°pida para conseguir guiones listos para grabar. Pega tu texto, elige el idioma y el ritmo, y recibe al instante una estimaci√≥n del tiempo de lectura con indicaciones para la colocaci√≥n de bloques de anuncios. Esta demo utiliza un ajuste fijo de palabras por minuto, as√≠ que a√±ade un peque√±o margen si prev√©s pausas dram√°ticas o una lectura m√°s lenta.`,
    de: `Das Voiceover AI Hub ist Ihre Schnellspur zu aufnahmebereiten Skripten. F√ºgen Sie Ihren Text ein, w√§hlen Sie Sprache und Sprechtempo, und erhalten Sie sofort eine Sch√§tzung der Lesezeit mit Hinweisen zur Platzierung von Werbeslots. Diese Demo verwendet feste W√∂rter-pro-Minute-Einstellungen; planen Sie daher einen kleinen Puffer ein, wenn Sie mit dramatischen Pausen oder einem langsameren Lesetempo rechnen.`,
    ko: `Î≥¥Ïù¥Ïä§Ïò§Î≤Ñ AI ÌóàÎ∏åÎäî Î∞îÎ°ú ÎÖπÏùåÏóê Ïì∏ Ïàò ÏûàÎäî Ïä§ÌÅ¨Î¶ΩÌä∏Î•º Îπ†Î•¥Í≤å Ï§ÄÎπÑÌï¥ Ï£ºÎäî ÎèÑÍµ¨ÏûÖÎãàÎã§.
ÌÖçÏä§Ìä∏Î•º Î∂ôÏó¨ÎÑ£Í≥†, Ïñ∏Ïñ¥ÏôÄ ÏÜçÎèÑÎ•º ÏÑ†ÌÉùÌïòÎ©¥, Í¥ëÍ≥† Ïä¨Î°Ø Íµ¨ÏÑ±Ïóê ÎèÑÏõÄÏù¥ ÎêòÎäî ÏòàÏÉÅ ÎÇ≠ÎèÖ ÏãúÍ∞ÑÏùÑ Î∞îÎ°ú ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
Ïù¥ Îç∞Î™®Îäî Í≥†Ï†ïÎêú Î∂ÑÎãπ Îã®Ïñ¥ Ïàò Í∏∞Ï§ÄÏùÑ ÏÇ¨Ïö©ÌïòÎØÄÎ°ú, Í∑πÏ†ÅÏù∏ Î©àÏ∂§Ïù¥ÎÇò ÎäêÎ¶∞ ÏùΩÍ∏∞Î•º ÏõêÌïúÎã§Î©¥ ÏïΩÍ∞ÑÏùò Ïó¨Ïú† ÏãúÍ∞ÑÏùÑ Îçî Ïû°Îäî Í≤ÉÏù¥ Ï¢ãÏäµÎãàÎã§.`
  };

  const themeToggle = document.getElementById("themeToggle");
  const scriptInput = document.getElementById("scriptInput");
  const languageSelect = document.getElementById("language");
  const paceSelect = document.getElementById("pace");
  const countNumbersToggle = document.getElementById("countNumbers");
  const wordCountEl = document.getElementById("wordCount");
  const charCountEl = document.getElementById("charCount");
  const durationEl = document.getElementById("duration");
  const durationDetailEl = document.getElementById("durationDetail");
  const wpmValueEl = document.getElementById("wpmValue");
  const longAlertEl = document.getElementById("longAlert");
  const clearButton = document.getElementById("clearButton");
  const sampleButton = document.getElementById("sampleButton");
  const limitAlertEl = document.getElementById("limitAlert");
  const copyButton = document.getElementById("copyButton");
  const copyFeedbackEl = document.getElementById("copyFeedback");
  const bufferMessageEl = document.getElementById("bufferMessage");
  const liveRegionEl = document.getElementById("liveRegion");
  const slotElements = Array.from(document.querySelectorAll(".slot"));
  const slotSeconds = slotElements.map(function (slot) {
    return parseInt(slot.dataset.seconds, 10);
  }).sort(function (a, b) {
    return a - b;
  });

  let currentBestSlot = null;
  let currentBufferSlot = null;
  let currentBufferedSeconds = 0;

  function applyTheme(theme) {
    const isLight = theme === "light";
    document.body.classList.toggle("theme-light", isLight);
    if (themeToggle) {
      const label = isLight ? THEME_LABELS.light : THEME_LABELS.dark;
      const icon = isLight ? THEME_ICONS.light : THEME_ICONS.dark;
      themeToggle.textContent = icon;
      themeToggle.setAttribute("aria-pressed", isLight ? "true" : "false");
      themeToggle.setAttribute("aria-label", label);
      themeToggle.title = label;
    }
    try {
      localStorage.setItem(THEME_KEY, isLight ? "light" : "dark");
    } catch (err) {
      // Ignore storage issues
    }
  }

  function hydrateTheme() {
    try {
      const savedTheme = localStorage.getItem(THEME_KEY);
      if (savedTheme === "light" || savedTheme === "dark") {
        applyTheme(savedTheme);
        return;
      }
    } catch (err) {
      // Ignore storage issues
    }
    applyTheme("dark");
  }

  function getSampleScript(lang) {
    return SAMPLE_SCRIPTS[lang] || SAMPLE_SCRIPTS.en;
  }

  function sanitizeInput(value) {
    return value
      .replace(/\u00a0/g, " ")
      .replace(/[ \t]+/g, " ")
      .replace(/\n{3,}/g, "\n\n")
      .trim();
  }

  function clampInputLength() {
    if (scriptInput.value.length > MAX_CHARS) {
      scriptInput.value = scriptInput.value.slice(0, MAX_CHARS);
      limitAlertEl.style.display = "inline-block";
    } else {
      limitAlertEl.style.display = "none";
    }
  }

  function countWords(text, countNumbers) {
    const normalized = text
      .replace(/\u00a0/g, " ")
      .replace(/[‚Äî‚Äì]/g, " ")
      .replace(/-/g, " ")
      .trim();

    if (!normalized) return 0;

    const tokens = normalized.match(
      /[A-Za-z√Ä-√ø\u3130-\u318F\uAC00-\uD7A3]+(?:['‚Äô][A-Za-z√Ä-√ø\u3130-\u318F\uAC00-\uD7A3]+)?|\d+(?:[.,]\d+)?/g
    );

    if (!tokens) return 0;

    return tokens.filter(function (token) {
      const isNumber = /^\d/.test(token);
      return countNumbers ? true : !isNumber;
    }).length;
  }

  function formatDuration(seconds) {
    if (seconds <= 0) {
      return { label: "0 s", detail: "0:00 (min:sec)" };
    }
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    const label =
      seconds < 60
        ? seconds + " s"
        : mins + " min " + (secs ? secs + " s" : "");
    const detail = mins + ":" + String(secs).padStart(2, "0") + " (min:sec)";
    return { label, detail };
  }

  function findSlot(seconds) {
    let best = null;
    slotSeconds.forEach(function (sec) {
      if (seconds <= sec && (best === null || sec < best)) {
        best = sec;
      }
    });
    return best;
  }

  function updateSlots(totalSeconds) {
    let bestFitElement = null;
    let bestFitSeconds = null;

    slotElements.forEach(function (slot) {
      const tag = slot.querySelector(".tag");
      slot.classList.remove("best-fit", "too-short", "too-long");
      tag.textContent = "";
    });

    if (totalSeconds === 0) {
      longAlertEl.style.display = "none";
      currentBestSlot = null;
      return null;
    }

    slotElements.forEach(function (slot) {
      const sec = parseInt(slot.dataset.seconds, 10);
      if (totalSeconds <= sec) {
        if (bestFitSeconds === null || sec < bestFitSeconds) {
          bestFitSeconds = sec;
          bestFitElement = slot;
        }
      }
    });

    if (!bestFitElement) {
      longAlertEl.style.display = "block";
      currentBestSlot = null;
      slotElements.forEach(function (slot) {
        slot.classList.add("too-short");
      });
      return null;
    }

    longAlertEl.style.display = "none";
    currentBestSlot = bestFitSeconds;

    slotElements.forEach(function (slot) {
      const sec = parseInt(slot.dataset.seconds, 10);
      const tag = slot.querySelector(".tag");

      if (slot === bestFitElement) {
        slot.classList.add("best-fit");
        tag.textContent = "closest fit";
      } else if (sec < totalSeconds) {
        slot.classList.add("too-short");
        tag.textContent = "shorter";
      } else {
        slot.classList.add("too-long");
        tag.textContent = "longer";
      }
    });

    return bestFitSeconds;
  }

  function updateBuffer(totalSeconds) {
    function setBufferColor(tone) {
      const isLight = document.body.classList.contains("theme-light");
      const info = isLight ? "#0ea5e9" : "#a5f3fc";
      const warn = isLight ? "#b45309" : "#fbbf24";
      bufferMessageEl.style.color = tone === "warn" ? warn : info;
    }

    if (totalSeconds === 0) {
      bufferMessageEl.textContent =
        "Add script text to see your safety buffer fit.";
      setBufferColor("info");
      currentBufferSlot = null;
      currentBufferedSeconds = 0;
      return null;
    }

    const bufferedSeconds = Math.ceil(totalSeconds * BUFFER_MULTIPLIER);
    const bufferSlot = findSlot(bufferedSeconds);
    currentBufferedSeconds = bufferedSeconds;
    currentBufferSlot = bufferSlot;

    if (!bufferSlot) {
      bufferMessageEl.textContent =
        "With a " +
        BUFFER_LABEL +
        "% safety buffer (" +
        bufferedSeconds +
        "s), this runs longer than a 90 s slot.";
      setBufferColor("warn");
      return null;
    }

    bufferMessageEl.textContent =
      BUFFER_LABEL +
      "% buffer => " +
      bufferedSeconds +
      "s, fits " +
      bufferSlot +
      " s slot.";
    setBufferColor("info");
    return bufferSlot;
  }

  function describeSlot(slotSeconds) {
    return slotSeconds ? slotSeconds + " s slot" : "longer than 90 s";
  }

  function updateLiveRegion(words, totalSeconds, bestSlot) {
    const status =
      "Words: " +
      words +
      ". Duration: " +
      durationEl.textContent +
      ". " +
      (bestSlot
        ? "Closest ad slot: " + bestSlot + " seconds."
        : "Script exceeds defined ad slots.");
    liveRegionEl.textContent = status;
  }

  function persistState() {
    try {
      const payload = {
        script: scriptInput.value,
        language: languageSelect.value,
        pace: paceSelect.value,
        countNumbers: countNumbersToggle.checked
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(payload));
    } catch (err) {
      // Ignore storage issues
    }
  }

  function hydrateState() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return;
      const saved = JSON.parse(raw);
      if (typeof saved.script === "string") {
        scriptInput.value = saved.script.slice(0, MAX_CHARS);
      }
      if (saved.language === "other") {
        saved.language = "ko";
      }
      if (saved.language && WPM_TABLE[saved.language]) {
        languageSelect.value = saved.language;
      }
      if (saved.pace && paceSelect.querySelector("option[value='" + saved.pace + "']")) {
        paceSelect.value = saved.pace;
      }
      if (typeof saved.countNumbers === "boolean") {
        countNumbersToggle.checked = saved.countNumbers;
      }
    } catch (err) {
      // Ignore hydration issues
    }
  }

  function recalculate() {
    clampInputLength();
    const text = scriptInput.value;
    const words = countWords(text, countNumbersToggle.checked);
    const chars = text.length;

    const lang = languageSelect.value in WPM_TABLE ? languageSelect.value : "en";
    const pace = paceSelect.value;
    const wpm = WPM_TABLE[lang][pace];

    wordCountEl.textContent = words;
    charCountEl.textContent = chars + " / " + MAX_CHARS + " characters";
    wpmValueEl.textContent = wpm;

    if (words === 0) {
      durationEl.textContent = "0 s";
      durationDetailEl.textContent = "0:00 (min:sec)";
      updateSlots(0);
      updateBuffer(0);
      updateLiveRegion(0, 0, null);
      persistState();
      return;
    }

    const minutes = words / wpm;
    const totalSeconds = Math.max(1, Math.round(minutes * 60));
    const formatted = formatDuration(totalSeconds);

    durationEl.textContent = formatted.label;
    durationDetailEl.textContent = formatted.detail;

    const bestSlot = updateSlots(totalSeconds);
    updateBuffer(totalSeconds);
    updateLiveRegion(words, totalSeconds, bestSlot);
    persistState();
  }

  function copyStats() {
    const words = wordCountEl.textContent;
    const duration = durationEl.textContent;
    const detail = durationDetailEl.textContent;
    const wpm = wpmValueEl.textContent;
    const bestSlot = describeSlot(currentBestSlot);
    const bufferSlot = currentBufferedSeconds
      ? describeSlot(currentBufferSlot) + " (" + currentBufferedSeconds + "s buffered)"
      : "not calculated";

    const payload =
      "Script timing summary:\n" +
      "- Words: " + words + "\n" +
      "- Duration: " + duration + " (" + detail + ")\n" +
      "- WPM used: " + wpm + "\n" +
      "- Closest slot: " + bestSlot + "\n" +
      "- Safety buffer: " + bufferSlot;

    navigator.clipboard.writeText(payload).then(
      function () {
        copyFeedbackEl.style.display = "inline-block";
        copyFeedbackEl.textContent = "Copied";
        setTimeout(function () {
          copyFeedbackEl.style.display = "none";
        }, 1400);
      },
      function () {
        copyFeedbackEl.style.display = "inline-block";
        copyFeedbackEl.textContent = "Clipboard blocked";
        setTimeout(function () {
          copyFeedbackEl.style.display = "none";
        }, 1600);
      }
    );
  }

  function handleClear() {
    scriptInput.value = "";
    recalculate();
    scriptInput.focus();
  }

  if (themeToggle) {
    themeToggle.addEventListener("click", function () {
      const nextTheme = document.body.classList.contains("theme-light") ? "dark" : "light";
      applyTheme(nextTheme);
    });
  }

  scriptInput.addEventListener("input", recalculate);
  languageSelect.addEventListener("change", recalculate);
  paceSelect.addEventListener("change", recalculate);
  countNumbersToggle.addEventListener("change", recalculate);

  scriptInput.addEventListener("paste", function (event) {
    const data =
      event.clipboardData && event.clipboardData.getData
        ? event.clipboardData.getData("text")
        : "";
    event.preventDefault();
    const cleaned = sanitizeInput(data).slice(0, MAX_CHARS);
    scriptInput.value = cleaned;
    recalculate();
    scriptInput.focus();
  });

  sampleButton.addEventListener("click", function () {
    const sample = getSampleScript(languageSelect.value);
    scriptInput.value = sample.slice(0, MAX_CHARS);
    recalculate();
    scriptInput.focus();
  });

  clearButton.addEventListener("click", handleClear);
  copyButton.addEventListener("click", copyStats);

  document.addEventListener("keydown", function (event) {
    const isMetaEnter = (event.metaKey || event.ctrlKey) && event.key === "Enter";
    if (isMetaEnter) {
      event.preventDefault();
      copyStats();
    }
    if (event.key === "Escape") {
      event.preventDefault();
      handleClear();
    }
  });

  hydrateTheme();
  hydrateState();
  // Initial calculation
  recalculate();
</script>
</body>
</html>
